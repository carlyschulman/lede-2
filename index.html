<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NBA's Smartest Team</title>

  <!-- Google fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400;1,700&display=swap"
    rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

   <style>
    body {
      margin: 0;
      font-size: 20px;
      font-family: 'Raleway', 'Raleway', Tahoma, serif;
      text-rendering: optimizeLegibility;
    }

    .content {
      max-width: 640px;
      margin: auto;
    }

    .header {
      padding: 3em 0;


    }

    .header {
        text-align: center;
        padding: 3em 0;
        height: 50vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    
    #chart {
        width: 100%;
        height: 600px; /* Adjust as needed */
    }



    a {
      color: #f05349;
    }

    .footer {
      background: #f4f4f4;
      text-align: center;
      font-size: 0.8em;
      margin-top: 4em;
      padding: 4em 0;
    }

    figure {
      margin: 0;
      padding-bottom: 1.2em;
    }

    figcaption {
      font-family: 'Roboto Condensed', Georgia, serif;  
      font-size: 0.8em;
      text-align: center;
      margin-top: 0.5em;
      color: #666;
    }

    h1 {
      font-family: 'Raleway', Tahoma, serif;
      font-weight: bold;
      font-size: 3em;
      line-height: 1.1;
      margin-bottom: 0.5em;
    }

    .subhead {
      font-family: 'Roboto Condensed', Georgia, serif;
      font-size: 1.5em;
    }

    iframe,
    img,
    video {
      max-width: 100%;
    }

    p {
      line-height: 1.6;
      margin: 0;
      padding-bottom: 1.2em;
    }

    ul {
      margin: 0;
      padding-bottom: 1em;
      line-height: 1.6;
    }

    iframe {
      padding-bottom: 1.2em;
    }

    .full-width figure {
      text-align: center;
    }

    code {
      font-family: 'Courier New', monospace;
      background: #fff880;
    }

    /* margin on mobile */
    @media (max-width: 640px) {
      body {
        font-size: 18px;
      }

      .content {
        padding-left: 0.5em;
        padding-right: 0.5em;
      }
    }
  </style>
  <link href="scrolly-styles.css" rel="stylesheet">
  <script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/scrollama/3.2.0/scrollama.min.js"></script>

</head>

<body>
  <div class="content">

    <div class="header">
      <h1>Who is the NBA's Smartest Team?</h1>
      <p class="subhead">An analysis of players' college rankings</p>
    </div>
    <div class="byline">
      <p>By <a href="https://carlyschulman.com">Carly Schulman</a></p>
    </div>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
      magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
      consequat.</p>
    <p>You can change the fonts by using <a href="https://fonts.google.com/">Google Fonts</a> and some CSS. Right now
      we're using Lora for headlines and Georgia for body copy.</a></p>
    <p>You will need <code><a href="scrolly-styles.css">scrolly-styles.css</a></code> for the page to work for you.</p>
    <p>Remove <code>debug: true</code> from the code near the bottom of the page to make the black lines go away, and
      <strong>make sure you change the background color of the overlays</strong>. Otherwise I will go crazy.
    </p>
  </div>
  <section id="scrolly-images" class="scrolly-container">
    <div class="sticky-thing">
        <div id="chart"></div>
      </div>
      <div class="steps-container">
        <div class="step" id="step1">
          <div class="step-content">

          <p>
            
            During the 2022-2023 NBA season, 539 players appeared in at least one game. </p>
          
          </div>
        </div>
      <div class="step" id="step2">
        <div class="step-content">
            <p>These players represented 135 unique colleges.</p>

            <p>65 players <span style="color: #808080; font-weight: bold;">did not attend college</span> or did not attend college in the USA.</p>
        </div>
        
      </div>
      <div class="step" id="step3">
        <p>The most well-represented college was <span style="color: #0033A0; font-weight: bold;">Kentucky</span> with 27 players, follwed closely 
            by <span style="color: #003087; font-weight: bold;">Duke</span> with 26 players. 
            <span style="color: #CC0033; font-weight: bold;">Arizona</span> took third place with 14 players.
        </p>
      </div>
      <div class="step" id="step4">
        <p>87 players attended top 25 universities, including <span style="color: #8C1515; font-weight: bold;">Stanford</span> (#3), 
            <span style="color: #003087; font-weight: bold;">Duke</span> (#7), 
            <span style="color: #003262; font-weight: bold;">California</span> (#15), 
            <span style="color: #2774AE; font-weight: bold;">UCLA</span> (#15), 
            <span style="color: #866D4B; font-weight: bold;">Vanderbilt</span> (#18),
            <span style="color: #0C2340; font-weight: bold;">Notre Dame</span> (#20), 
            <span style="color: #00274C; font-weight: bold;">Michigan</span> (#21), 
            <span style="color: #9F8D80; font-weight: bold;">Georgetown</span> (#22), 
            <span style="color: #7BAFD4; font-weight: bold;">North Carolina</span> (#22) and 
            <span style="color: #232D4B; font-weight: bold;">Virginia</span> (#24).
        This means roughly 16% of players attended a top-25 ranked college.</p>
      </div>
      <div class="step" id="step5">
        <p>Step five, lorem ipsum dolor sic amet.</p>
      </div>
    </div>
  </section>
  <div class="content">
    <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem
      aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo
      enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui
      ratione voluptatem sequi nesciunt.</p>
    <figure>
      <img
        src="team_mean_ranking.svg" alt = "NBA Team Mean College Rankings">
      <figcaption>This is an image caption</figcaption>
    </figure>
    <p>Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non
      numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima
      veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?
    </p>
    <div id="chart"></div>
  </div>
  <div class="full-width">
    <figure>
      <img
        
        src="https://static01.nyt.com/images/2024/02/01/multimedia/01eu-hungary-orban-2-ghkw/01eu-hungary-orban-2-ghkw-superJumbo.jpg?quality=75&auto=webp">
      <figcaption>This is another image caption, but this time it's a full-width image</figcaption>
    </figure>
  </div>
  <div class="content">
    <p>At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque
      corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa
      qui officia deserunt mollitia animi, id est laborum et dolorum fuga.</p>

      <div class="flourish-embed flourish-scatter" data-src="visualisation/18960945">
        <script src="https://public.flourish.studio/resources/embed.js"></script>
      </div>

    <p>Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio
      cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor
      repellendus.</p>
      

  </div>
  <div class="footer">
    <div class="content">
      <p>Carly Schulman 2024</p>
    </div>
  </div>


  <script>
    (() => {
        const scroller = scrollama()
    
        scroller
            .setup({
                parent: document.querySelector("#scrolly-images"),
                step: ".step",
                offset: 0.6,
            })
            .onStepEnter(function ({ index, direction }) {
                if (chartSteps) {
                    switch(index) {
                        case 0:
                            chartSteps.step1();
                            break;
                        case 1:
                            chartSteps.step2();
                            break;
                        case 2:
                            chartSteps.step3();
                            break;
                        case 3:
                            chartSteps.step4();
                            break;
                        case 4:
                            chartSteps.step5();
                            break;
                        // Add more cases if you have more steps
                    }
                }
            });
    
        window.addEventListener("resize", scroller.resize);
    })();
    </script>
  <style>
    /* Change this to adjust the padding between steps */
    .tooltip {
    position: absolute;
    background-color: white;
    border: 1px solid #ddd;
    padding: 10px;
    pointer-events: none;
    z-index: 10;
    }

    .step {
        margin-top: 30vh;
      margin-bottom: 70vh;
    }
  </style>

<script src="https://d3js.org/d3.v7.min.js"></script>

<script>
    // Function to create the visualization
    function createVisualization(selector, nbaPlayersData) {
    const container = d3.select(selector);
    const width = container.node().getBoundingClientRect().width;
    const height = container.node().getBoundingClientRect().height;

    const svg = container
        .append("svg")
        .attr("viewBox", `0 0 ${width} ${height}`)
        .style("display", "block")
        .style("margin", "auto")
        .append("g")
        .attr("transform", `translate(${width/2},${height/2})`);

    const rows = 30;
    const cols = Math.ceil(nbaPlayersData.length / rows);
    const gridSize = Math.min(width / cols, height / rows);
    
    // Create a tooltip
    const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);
    
    svg.selectAll("circle")
        .data(nbaPlayersData)
        .enter()
        .append("circle")
        .attr("cx", (d, i) => ((i % cols) - (cols-1)/2) * gridSize)
        .attr("cy", (d, i) => (Math.floor(i / cols) - (rows-1)/2) * gridSize)
        .attr("r", gridSize / 2.5)
        .attr("fill", "grey")  // Start with all circles grey
        .attr("original-color", d => d.color)  // Store original color as an attribute
        .on("mouseover", function(event, d) {
                tooltip.transition()
                    .duration(200)
                    .style("opacity", .9);
                tooltip.html(d.name + "<br/>" + (d.college || "No College"))
                    .style("left", (event.pageX + 5) + "px")
                    .style("top", (event.pageY - 28) + "px");
                    
                    // add font here
        })
        .on("mouseout", function(d) {
                tooltip.transition()
                    .duration(500)
                    .style("opacity", 0);
            });
    
    // Functions to update the chart based on scroll position
    function step1() {
        svg.selectAll("circle")
            .transition()
            .duration(500)
            .attr("fill", "grey");
    }

    function step2() {
        svg.selectAll("circle")
            .transition()
            .duration(500)
            .attr("fill", d => d.color);
    }

    function step3() {
        svg.selectAll("circle")
            .transition()
            .duration(500)
            .attr("fill", d => {
                if (d.college === "Duke" || d.college === "Kentucky" || d.college === "Arizona") {
                    return d.color;
                } else {
                    return "grey";
                }
            });
    }

    function step4() {
        svg.selectAll("circle")
            .transition()
            .duration(500)
            .attr("fill", d => {
                if (d.college === "Stanford" || d.college === "Duke" ||  d.college === "Virginia" || 
                d.college === "California" || d.college === "Vanderbilt" || d.college === "UCLA" || 
                d.college === "Michigan" || d.college === "Notre Dame" || d.college === "Georgetown" ) {
                    return d.color;
                } else {
                    return "grey";
                }
            });
    }
    
    function step5() {
        svg.selectAll("circle")
            .transition()
            .duration(500)
            .attr("fill", d => d.color);
    }
    

    // Return the step functions so they can be used in the scrollytelling setup
    return { step1, step2, step3, step4, step5 };
}

// Load the data and set up the chart
let chartSteps;
d3.json("./nba_players_data.json").then(function(data) {
    if (data && data.length > 0) {
        chartSteps = createVisualization("#chart", data);
    } else {
        console.error("Data is empty or undefined");
    }
}).catch(function(error) {
    console.error("Error loading the JSON file:", error);
});
    </script>


</body>

</html>